<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie-edge">
    <title>Document</title>
    <script src="js/pixi.min.js"></script>
    <script>
        let app;
        let player;
        let enemy;


        window.onload = function() {
            app = new PIXI.Application(
                {
                width: 800, 
                height: 600,
                backgroundColor: 0xAAAAAA
                }
            );

            document.body.appendChild(app.view)
      

        //preload assets

            app.loader.baseUrl = "images";
            app.loader
                .add("player", "/pixel_cat.png")
                .add("enemy", "/Dead.png")

            app.loader.onProgress.add(showProgress)
            app.loader.onComplete.add(doneLoading)
            app.loader.onError.add(reportErrors)

            app.loader.load()

        }

        function showProgress(e) {
            console.log(e.progress)
        }

        function reportErrors(e) {
            console.log("ERROR: " + e.message)
        }

        function doneLoading(e) {
            console.log("DONE LOADING!")

            //player object

            player = PIXI.Sprite.from(app.loader.resources.player.texture);
            player.x = 200
            player.y = app.view.height / 2
            player.anchor.set(0.5);

            enemy = PIXI.Sprite.from(app.loader.resources.enemy.texture);
            enemy.x = 16
            enemy.y = app.view.height / 2
            enemy.anchor.set(0.5);

            app.stage.addChild(player);
            app.stage.addChild(enemy);

            window.addEventListener("keydown", keysDown)
            window.addEventListener("keyup", keysUp)

            app.ticker.add(gameLoop)

            keysDiv = document.querySelector("#keys")

        }
            function keysDown(e) {
                keys[e.keyCode] = true;
            }

             function keysUp(e) {
                 keys[e.keyCode] = false;
            }

            function gameLoop() {
                enemy.x += 3

                if(keys["68"]) {
                    player.x += 5
                }
                
                if (rectsIntersect(player, enemy)) {
                    
                }
 

            }

            function rectsIntersect(a, b) {
                let aBox = a.getBounds()
                let bBox = b.getBounds()

                return aBox.x + aBox.width > bBox.x && 
                    aBox.x < bBox.x + bBox.width
            }

    </script>
</head>
<body>    
    <div id="keys"></div>
</body>
</html>